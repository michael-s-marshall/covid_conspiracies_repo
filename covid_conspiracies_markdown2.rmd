---
title: "covid_conspiracies_markdown2"
author: "Michael Marshall"
date: "21/10/2020"
output: github_document
---

## Loading Packages and Data

```{r, message = FALSE, warnings = FALSE}
pacman::p_load(tidyverse, stringr, ggridges, forcats, labelled, leaps,
               psych, corrr, cowplot, expss, haven, interplot,
               interactions, jtools,labelled, pscl, psych, 
               sjPlot, skimr)

load("COVID W1_W2_W3 Cleaned 2878.RData") # needs to be in your wd
```

## Rescaling variable

```{r}
## [rescale01] Function to rescale a variable from 0 to 1
rescale01 <- function(x, ...) {
  (x - min(x, ...)) / ((max(x, ...)) - min(x, ...))
}
```

## Summary and distribution of different COVID specific conspiracies

```{r}
# plotting density of different covid conspiracies
df %>% 
  dplyr::select(W2_Conspiracy_Theory1:W2_Conspiracy_Theory5) %>% 
  gather(conspiracy_code, belief,
         W2_Conspiracy_Theory1:W2_Conspiracy_Theory5) %>%
  mutate(
    conspiracy_code = as.factor(conspiracy_code),
    conspiracy = ifelse(
      conspiracy_code == "W2_Conspiracy_Theory1",
      "Chinese lab",
      ifelse(conspiracy_code == "W2_Conspiracy_Theory2",
             "Chinese meat market",
             ifelse(conspiracy_code == "W2_Conspiracy_Theory3",
                    "5G",
                    ifelse(conspiracy_code == "W2_Conspiracy_Theory4",
                           "No worse than flu",
                           "Vitamin C treatment"))))
  ) %>% 
  ggplot(aes(x = belief, y = conspiracy, height = ..density..)) +
  geom_density_ridges(aes(fill = conspiracy,
                          rel_min_height = 0.005),
                      stat = "density",
                      #bins = 20,
                      show.legend = FALSE) +
  scale_fill_brewer(palette = "Dark2") +
  theme_ridges()
```

## Cleaning dataset

The following code filters down to just those observations that have completed the battery of questions relating to COVID specific conspiracies.  It also creates a tibble counting the missing observations, which can be useful to have as an object.  

```{r}
# filtering for completed dependent variable
conspiracies <- df %>% 
  filter(!is.na(W2_Conspiracy_Theory1) |
           !is.na(W2_Conspiracy_Theory2) |
           !is.na(W2_Conspiracy_Theory3) |
           !is.na(W2_Conspiracy_Theory3) |
           !is.na(W2_Conspiracy_Theory4) |
           !is.na(W2_Conspiracy_Theory5)) %>% 
  rename(W1_Housing_tenure = W1_Hosuing_tenure)

# function to count NAs
count_na <- function(x){
  sum(is.na(x))
}

conspiracies %>% 
  dplyr::select(W2_Conspiracy_Theory1:W2_Conspiracy_Theory5) %>% 
  map_int(count_na)

missing <- tibble(
  variable = names(conspiracies),
  NAs = conspiracies %>% map_int(count_na)
)

#View(missing)
```

The code below combines the two variables on the 2019 general election into a single variable that combines whether a respondent voted, and who they voted for.  It also turns the *preferred newspaper* variables into dummy variables, as they were previously coded as *1=Yes* and everything else as *NA*.  

```{r}
# combining 2019 election variables into one, for parties and didn't votes

conspiracies <- conspiracies %>% 
  mutate(
    W1_Voted_Party_Name = to_factor(
      conspiracies$W1_Voted_Party,
      nolabel_to_na = TRUE),
    W1_Voted_GenElection_Name = to_factor(
      conspiracies$W1_Voted_GenElection,
      nolabel_to_na = TRUE),
    W1_2019_GE_Full = factor(ifelse(
      W1_Voted_GenElection_Name == "Voted.",
      as.character(W1_Voted_Party_Name),
      as.character(W1_Voted_GenElection_Name)))
    )

# making preferred newspaper dummy variable (i.e. replacing NA with 0)
na_to_zero <- function(x){
  x[is.na(x)] <- 0
  x <- as.numeric(x)
  return(x)
} 

paper_vars <- conspiracies %>%
  dplyr::select(W2_Newspaper_prefer1:W2_Newspaper_prefer11) %>% 
  names()

conspiracies[paper_vars] <- conspiracies[paper_vars] %>% 
  map_df(na_to_zero)
```

```{r}
# Creating DVs
# [nat] nationalism
nat_keys <- list(nationalism = cs(W2_Nationalism1,W2_Nationalism2))
nat_test <- scoreItems(nat_keys, conspiracies, min = 1, max = 5)
head(nat_test$scores)
nat_test$alpha  # Scale alpha
conspiracies$nat <- rescale01(nat_test$scores, na.rm = TRUE)
conspiracies$nat <- c(conspiracies$nat)  # Ensure variable is numeric and not matrix class
describe(conspiracies$nat)
```

```{r}
## [imm.econ] Anti-immigrant sentiment - Economy 
table(conspiracies$W1_MigrantAttitudes1)
conspiracies$imm_econ <- rescale01(abs(
  conspiracies$W1_MigrantAttitudes1 - 11))

conspiracies %>% 
  dplyr::select(W1_MigrantAttitudes1, imm_econ) %>%
  correlate()

## [imm.res] Anti-immigrant sentiment - Resources
table(conspiracies$W1_MigrantAttitudes3)
conspiracies$imm_res <- rescale01(conspiracies$W1_MigrantAttitudes3)
conspiracies %>% 
  dplyr::select(W1_MigrantAttitudes3, imm_res) %>%
  correlate()

## [imm.cul] Anti-immigrant sentiment - Culture
table(conspiracies$W1_MigrantAttitudes2)
conspiracies$imm_cul <- rescale01(abs(
  conspiracies$W1_MigrantAttitudes2 - 11))

conspiracies %>% 
  dplyr::select(W1_MigrantAttitudes2, imm_cul) %>%
  correlate()
```

```{r}
# Right wing authoritarianism
rwa_keys <- list(rwa = cs(W1_Authoritarianism1_R,
                          W1_Authoritarianism2,
                          W1_Authoritarianism3,
                          W1_Authoritarianism4_R, 
                          W1_Authoritarianism5_R,
                          W1_Authoritarianism6))

rwa_test <- scoreItems(rwa_keys, conspiracies, min = 1, max = 5)
head(rwa_test$scores)
summary(rwa_test$alpha)  # Scale alpha
conspiracies$RWA <- rescale01(rwa_test$scores, na.rm = TRUE)
conspiracies$RWA <- c(conspiracies$RWA)  # Ensure variable is numeric and not matrix class

describe(conspiracies$RWA)
```

```{r}
## [SDO] Social Dominance Orientation
sdo_keys <- list(sdo = cs(W1_Social_Dominance1,
                          W1_Social_Dominance2_R,
                          W1_Social_Dominance3_R,
                          W1_Social_Dominance4,
                          W1_Social_Dominance5_R,
                          W1_Social_Dominance6, 
                          W1_Social_Dominance7,
                          W1_Social_Dominance8_R))
sdo_test <- scoreItems(sdo_keys, conspiracies, min = 1, max = 5)
head(sdo_test$scores)
summary(sdo_test$alpha)  # Scale alpha
conspiracies$SDO <- rescale01(sdo_test$scores, na.rm = TRUE)
conspiracies$SDO <- c(conspiracies$SDO)  # Ensure variable is numeric and not matrix class

summary(conspiracies$SDO)
```

```{r}
## [threat] Covid-19 related Threat
summary(conspiracies$W2_COVID19_anxiety)
conspiracies$threat <- rescale01(conspiracies$W2_COVID19_anxiety)
conspiracies %>% 
  dplyr::select(W2_COVID19_anxiety, threat) %>%
  correlate()
```

```{r}
## [right] Right-Wing political views
table(conspiracies$W1_Political_Scale)
conspiracies$right <- rescale01(conspiracies$W1_Political_Scale)
conspiracies %>% 
  dplyr::select(W1_Political_Scale, right) %>%
  correlate()
```

```{r}
## [soc.con] Social conservatism
table(conspiracies$W1_Political_Abortion_SSM)
conspiracies$soc_con <- rescale01(
  conspiracies$W1_Political_Abortion_SSM)
conspiracies %>% 
  dplyr::select(W1_Political_Abortion_SSM, soc_con) %>%
  correlate()
```

```{r}
## [fis.con] Fiscal conservatism
table(conspiracies$W1_Political_Fiscal)
conspiracies$fis_con <- rescale01(conspiracies$W1_Political_Fiscal)
conspiracies %>% 
  dplyr::select(W1_Political_Fiscal, fis_con) %>%
  correlate()
```

```{r}
## [age.c] Age (in years)
summary(conspiracies$W2_Age_year)
conspiracies$age_sc <- rescale01(conspiracies$W2_Age_year)
```


```{r}
factors <- c("W1_Ethnicity","W1_C19_Infected",
             "W1_CRT1","W1_CRT2","W1_CRT3","W1_CRT4",
             "W1_CRT5","W1_CRT_test","W1_BornUK","W1_EURef",
             "W2_Gender_binary","W2_Living_alone","W2_Employment",
             "W1_Education_binary","W1_Housing_tenure")
```

```{r}
# turning the above list into factors with the levels as the spss labels
#for(i in seq_along(conspiracies[factors])){
#  conspiracies[factors][,i] <- to_factor(
#    conspiracies[factors][,i], nolabel_to_na = TRUE)
#}
```

```{r}
# turning to factors
conspiracies[factors] <- conspiracies[factors] %>% 
  map_df(as.factor)
```

```{r}
# Making a binary for each CRT scale, baseline = correct answer
conspiracies$CRT1 <- ifelse(
  to_factor(conspiracies$W1_CRT1) != "5 pence", 1, 0
)

conspiracies$CRT2 <- ifelse(
  to_factor(conspiracies$W1_CRT2) != "5 minutes", 1, 0
)

conspiracies$CRT3 <- ifelse(
  to_factor(conspiracies$W1_CRT3) != "47 days", 1, 0
)

conspiracies$CRT4 <- ifelse(
  to_factor(conspiracies$W1_CRT4) != "2nd", 1, 0
)

conspiracies$CRT5 <- ifelse(
  to_factor(conspiracies$W1_CRT5) != "8", 1, 0
)

conspiracies$CRT_test <- ifelse(
  to_factor(conspiracies$W1_CRT_test) == "None of them.", 1, 0
) # baseline = heard of some of them OR all of them
```

```{r}
# Making a binary for each CRT scale, 1 = most common wrong answer
conspiracies$CRT1_wrong <- ifelse(
  to_factor(conspiracies$W1_CRT1) == "10 pence", 1, 0
)

conspiracies$CRT2_wrong <- ifelse(
  to_factor(conspiracies$W1_CRT2) == "100 minutes", 1, 0
)

conspiracies$CRT3_wrong <- ifelse(
  to_factor(conspiracies$W1_CRT3) == "24 days", 1, 0
)

conspiracies$CRT4_wrong <- ifelse(
  to_factor(conspiracies$W1_CRT4) == "1st", 1, 0
)

conspiracies$CRT5_wrong <- ifelse(
  to_factor(conspiracies$W1_CRT5) == "7", 1, 0
)
```


```{r}
# rescaling the remaing numeric variables
numerics <- c("W1_Conspiracy_Total","W2_Paranoia_Total",
              "W2_Internal_Total","W2_Chance_Total","W2_PO_Total",
              "W2_DAI_Total","W2_IOU_Total", "W2_INFO_5",
              "W2_INFO_9","W2_Trust_Body6","W1_Income_2019")

conspiracies[numerics] <- conspiracies[numerics] %>% 
  map_df(rescale01, na.rm = TRUE)
```


```{r}
# creating scaled versions of each conspiracy belief
conspiracies$conspiracy1_sc <- rescale01(
  conspiracies$W2_Conspiracy_Theory1, na.rm = TRUE
)

conspiracies$conspiracy2_sc <- rescale01(
  conspiracies$W2_Conspiracy_Theory2, na.rm = TRUE
)

conspiracies$conspiracy3_sc <- rescale01(
  conspiracies$W2_Conspiracy_Theory3, na.rm = TRUE
)

conspiracies$conspiracy4_sc <- rescale01(
  conspiracies$W2_Conspiracy_Theory4, na.rm = TRUE
)

conspiracies$conspiracy5_sc <- rescale01(
  conspiracies$W2_Conspiracy_Theory5, na.rm = TRUE
)
```

## Distribution of variables

A for loop to look at distribution of potential independent variables (numeric only).  

```{r}
plot_vars <- conspiracies %>% 
  dplyr::select(
    one_of(numerics),nat,RWA,SDO,threat,right,soc_con,fis_con
    ) %>%
  names()

for(i in seq_along(plot_vars)){
  
  x1 <- conspiracies[plot_vars][i] %>% as_vector()
  
  print(
    ggplot(data = NULL, aes(x = x1)) +
      geom_vline(aes(xintercept = mean(x1, na.rm =TRUE)), 
                 colour = "black",
                 linetype = "dashed") +
      geom_vline(aes(xintercept = median(x1, na.rm =TRUE)), 
                 colour = "red",
                 linetype = "dashed") +
      geom_density(fill = "lightblue", alpha = 0.7) +
      labs(x = plot_vars[i],
           caption = "Black = Mean, Red = Median")  
  )
  
}
```


# Principal Components Analysis - PCA

```{r}
# pca on conspiracy theory variables
pca_df <- conspiracies %>% 
  dplyr::select(W2_Conspiracy_Theory1:W2_Conspiracy_Theory5)

pca_fit <- prcomp(pca_df,scale = TRUE)
```

```{r}
# looking at biplots for components 1:4
biplot(pca_fit,
       col = c("lightgrey","red"))

biplot(pca_fit, choices = 3:4,
       col = c("lightgrey","red"))

pca_fit$rotation[,1:4]

components <- pca_fit$x[,1:4] %>% as_tibble()
```

First four principal components are as follows:  
1. general conspiracy ideation, with belief in 5G, 'it's no worse than flu' and vitamin C treatment highly loaded to this component, and belief in Chinese lab less so  
2. disbelief in Chinese meat market origin, with mild positive loading for Chinese lab origin  
3. strong conspiracy ideation (non-nationalistic), strong loading for belig 5g, 'it's no worse than flu' and vitamin C treatment, with negative loading for both Chinese lab origin and Chinese meat market  
4. strong loading for belief in 5G conspiracy and vitamin C treatment, but strong negative loading for belief 'it's no worse than flu'  


```{r}
pc <- cbind(conspiracies,components)

ihs <- function(x){
  log(x + ((x^2 + 1)^0.5))
}

pc <- pc %>% 
  mutate(
    pc1_ihs = ihs(PC1)
  )

pc %>% 
  ggplot(aes(x = pc1_ihs)) +
  geom_density() +
  labs(x = "Principal Component 1 (IHS)")

pc %>% 
  ggplot(aes(x = PC2)) +
  geom_density() +
  labs(x = "Principal Component 2")

pc %>% 
  ggplot(aes(x = PC3)) +
  geom_density() +
  labs(x = "Principal Component 3")

pc %>% 
  ggplot(aes(x = PC4)) +
  geom_density()  +
  labs(x = "Principal Component 4")
```

Principal components 1 to 3 explain most of the variation in the data.  

```{r}
# modelling principal components against general conspiracy ideation
conspiracy_mod <- lm(W1_Conspiracy_Total ~ pc1_ihs + PC2 + PC3 + PC4,
                     data = pc)

par(mfrow = c(2,2))
plot(conspiracy_mod)

summ(conspiracy_mod, vifs = TRUE)

source("diagnostic_plots.R")
av_ggplot(conspiracy_mod)
```

Only principal components 1 and 3 associated with general conspiracy ideation.  


# Modelling for belief in Chinese lab origin

## DV Chinese lab conspiracy - singular IV models

```{r}
sdo_lab <- lm(W2_Conspiracy_Theory1 ~ SDO,
              data = conspiracies)

summ(sdo_lab)
```

```{r}
rwa_lab <- lm(W2_Conspiracy_Theory1 ~ RWA,
              data = conspiracies)

summ(rwa_lab)
```

```{r}
daily_m_lab <- lm(W2_Conspiracy_Theory1 ~ W2_Newspaper_prefer1,
              data = conspiracies)

summ(daily_m_lab)
```

```{r}
social_m_lab <- lm(W2_Conspiracy_Theory1 ~ W2_INFO_5,
              data = conspiracies)

summ(social_m_lab)
```

## DV Chinese lab conspiracy - socio-economic variables

```{r}
se_lab <- lm(W2_Conspiracy_Theory1 ~ W2_Gender_binary +
               W1_Education_binary +
               W1_Income_2019 +
               age_sc,
              data = conspiracies)

summ(se_lab, vifs = TRUE)
plot_coefs(se_lab)
par(mfrow = c(2,2))
plot(se_lab)
```

## DV Chinese lab conspiracy - socio-economic variables + political/media

```{r}
se_pol_lab <- lm(W2_Conspiracy_Theory1 ~ 
                   
                   #socio-economic variables
                   W2_Gender_binary +
                   W1_Education_binary +
                   W1_Income_2019 +
                   age_sc +
                   
                   #political and media variables
                   right +
                   soc_con +
                   fis_con +
                   nat +
                   W2_Trust_Body6 + #distrust of scientists
                   W2_Newspaper_prefer1 + #daily_mail
                   W2_Newspaper_prefer5 + #guardian
                   W2_Newspaper_prefer9 + #sun
                   W2_INFO_5 + #social media
                   W2_INFO_9, #family and friends
                 data = conspiracies)

summ(se_pol_lab, vifs = TRUE)
plot_coefs(se_pol_lab)
par(mfrow = c(2,2))
plot(se_pol_lab)
```

## DV Chinese lab conspiracy - socio-economic variables + political/media + pol-psych

```{r}
se_polpsych_lab <- lm(W2_Conspiracy_Theory1 ~
                        
                        #socio-economic variables
                        W2_Gender_binary +
                        W1_Education_binary +
                        W1_Income_2019 +
                        age_sc +
                        
                        #political and media variables
                        right +
                        soc_con +
                        fis_con +
                        nat +
                        W2_Trust_Body6 + #distrust of scientists
                        W2_Newspaper_prefer1 + #daily_mail
                        W2_Newspaper_prefer5 + #guardian
                        W2_Newspaper_prefer9 + #sun
                        W2_INFO_5 + #social media
                        W2_INFO_9 + #family and friends
                     
                        #political-psychology variables
                        SDO +
                        RWA +
                        W2_DAI_Total +
                        W2_IOU_Total +
                        W2_Paranoia_Total +
                        W2_Internal_Total +
                        W2_Chance_Total,
                      data = conspiracies)

summ(se_polpsych_lab, vifs = TRUE)
plot_coefs(se_polpsych_lab)
par(mfrow = c(2,2))
plot(se_polpsych_lab)
```

Looking at mulitcollinearity below for the following variables:  
* right  
* soc_con  
* fis_con  
* paranoia  

```{r}
# looking for potential multicollinearity with right
cor_mat <- model.matrix(se_polpsych_lab) %>% as.data.frame()

cor_vec <- rep(NA,ncol(cor_mat))
for(i in seq_along(cor_mat)){
  cor_vec[i] <- cor(cor_mat$right,cor_mat[,i])
}

tibble(cor_vec,
       names(cor_mat)) %>% 
  arrange(desc(cor_vec))
```

Fiscal conservatism positively correlated with right-left scale.  

```{r}
# looking for multicollinearity with soc_con
cor_vec2 <- rep(NA,ncol(cor_mat))
for(i in seq_along(cor_mat)){
  cor_vec2[i] <- cor(cor_mat$soc_con,cor_mat[,i])
}

tibble(cor_vec2,
       names(cor_mat)) %>% 
  arrange(desc(cor_vec2))
```

Fiscal conservatism, right-wing scale and RWA correlated with soc_con.  

```{r}
# looking for multicollinearity with fis_con
cor_vec3 <- rep(NA,ncol(cor_mat))
for(i in seq_along(cor_mat)){
  cor_vec3[i] <- cor(cor_mat$fis_con,cor_mat[,i])
}

tibble(cor_vec3,
       names(cor_mat)) %>% 
  arrange(desc(cor_vec3))
```

Right, soc_con correlated with fis_con.  

```{r}
# looking for multicollinearity with paranoia
cor_vec4 <- rep(NA,ncol(cor_mat))
for(i in seq_along(cor_mat)){
  cor_vec4[i] <- cor(cor_mat$W2_Paranoia_Total,cor_mat[,i])
}

tibble(cor_vec4,
       names(cor_mat)) %>% 
  arrange(desc(cor_vec4))
```

Potential multicollinearity between right, soc_con and fis_con. From hereon, fis_con is included in the models, as of the three, it shows the least positive correlation between SDO and RWA.  In addition, the variables relating to locus of control (W2_Internal_Total, W2_Chance_Total) are dropped due to non-significance.  

## DV Chinese lab belief - model above minus the aforementioned variables

```{r}
se_polpsych_lab_2 <- lm(W2_Conspiracy_Theory1 ~
                        
                        #socio-economic variables
                        W2_Gender_binary +
                        W1_Education_binary +
                        W1_Income_2019 +
                        age_sc +
                        
                        #political and media variables
                        fis_con +
                        nat +
                        W2_Trust_Body6 + #distrust of scientists
                        W2_Newspaper_prefer1 + #daily_mail
                        W2_Newspaper_prefer5 + #guardian
                        W2_Newspaper_prefer9 + #sun
                        W2_INFO_5 + #social media
                        W2_INFO_9 + #family and friends
                     
                        #political-psychology variables
                        SDO +
                        RWA +
                        W2_DAI_Total +
                        W2_IOU_Total +
                        W2_Paranoia_Total,
                      data = conspiracies)

summ(se_polpsych_lab_2, vifs = TRUE)
plot_coefs(se_polpsych_lab_2)
par(mfrow = c(2,2))
plot(se_polpsych_lab_2)
```


## DV Chinese lab conspiracy - socio-economic variables + political/media + pol-psych + covid-threat

```{r}
multi_lab <- lm(W2_Conspiracy_Theory1 ~
                  
                  #socio-economic variables
                  W2_Gender_binary +
                  W1_Education_binary +
                  W1_Income_2019 +
                  age_sc +
                  
                  #political and media variables
                  fis_con +
                  nat +
                  W2_Trust_Body6 + #distrust of scientists
                  W2_Newspaper_prefer1 + #daily_mail
                  W2_Newspaper_prefer5 + #guardian
                  W2_Newspaper_prefer9 + #sun
                  W2_INFO_5 + #social media
                  W2_INFO_9 + #family and friends
                  
                  #political-psychology variables
                  SDO +
                  RWA +
                  W2_DAI_Total +
                  W2_IOU_Total +
                  W2_Paranoia_Total +
                  
                  #covid-anxety
                  threat,
                data = conspiracies)

summ(multi_lab, vifs = TRUE)
plot_coefs(multi_lab)
par(mfrow = c(2,2))
plot(multi_lab)
```


## DV Chinese lab belief - interactions

```{r}
int_lab <- lm(W2_Conspiracy_Theory1 ~
                  
                  #socio-economic variables
                  W2_Gender_binary +
                  W1_Education_binary +
                  W1_Income_2019 +
                  age_sc +
                  
                  #political and media variables
                  fis_con +
                  nat +
                  W2_Trust_Body6 + #distrust of scientists
                  W2_Newspaper_prefer1 + #daily_mail
                  W2_Newspaper_prefer5 + #guardian
                  W2_Newspaper_prefer9 + #sun
                  
                  #political-psychology variables
                  SDO +
                  W2_DAI_Total +
                  W2_IOU_Total +
                  W2_Paranoia_Total +
                  
                  #covid-anxety
                  threat +
                  
                  #interactions
                  W2_INFO_5:RWA +
                  W2_INFO_9:RWA,
                data = conspiracies)

summ(int_lab, vifs = TRUE)
plot_coefs(int_lab)
par(mfrow = c(2,2))
plot(int_lab)
```


## DV Chinese lab conspiracy - full model incl. conspiracy ideation

```{r}
full_lab <- lm(W2_Conspiracy_Theory1 ~
                  
                  #socio-economic variables
                  W2_Gender_binary +
                  W1_Education_binary +
                  W1_Income_2019 +
                  age_sc +
                  
                  #political and media variables
                  fis_con +
                  nat +
                  W2_Trust_Body6 + #distrust of scientists
                  W2_Newspaper_prefer1 + #daily_mail
                  W2_Newspaper_prefer5 + #guardian
                  W2_Newspaper_prefer9 + #sun
                  W2_INFO_5 + #social media
                  W2_INFO_9 + #family and friends
                  
                  #political-psychology variables
                  SDO +
                  RWA +
                  W2_DAI_Total +
                  W2_IOU_Total +
                  W2_Paranoia_Total +
                  
                  #covid-anxety
                  threat +
                  
                  #conspiracies
                  W1_Conspiracy_Total +
                  conspiracy2_sc +
                  conspiracy3_sc,
                data = conspiracies)

summ(full_lab, vifs = TRUE)
plot_coefs(full_lab)
par(mfrow = c(2,2))
plot(full_lab)
```


```{r}
full_int_lab <- lm(W2_Conspiracy_Theory1 ~
                  
                  #socio-economic variables
                  W2_Gender_binary +
                  W1_Education_binary +
                  W1_Income_2019 +
                  age_sc +
                  
                  #political and media variables
                  fis_con +
                  nat +
                  W2_Trust_Body6 + #distrust of scientists
                  W2_Newspaper_prefer1 + #daily_mail
                  W2_Newspaper_prefer5 + #guardian
                  W2_Newspaper_prefer9 + #sun
                  #W2_INFO_5 + #social media
                  #W2_INFO_9 + #family and friends
                  
                  #political-psychology variables
                  SDO +
                  #RWA +
                  W2_DAI_Total +
                  W2_IOU_Total +
                  W2_Paranoia_Total +
                  
                  #covid-anxety
                  threat +
                  
                  #conspiracies
                  W1_Conspiracy_Total +
                  conspiracy2_sc +
                  conspiracy3_sc +
                  
                  #interaction
                  W2_INFO_5:RWA +
                  W2_INFO_9:RWA,
                data = conspiracies)

summ(full_int_lab, vifs = TRUE)
plot_coefs(full_int_lab)
par(mfrow = c(2,2))
plot(full_int_lab)
```

```{r}
# comparing the AIC with and without the interaction term
AIC(full_lab) 
AIC(full_int_lab)
# full_lab performs best
```


# Modelling for belief in 5G origin conspiracy

## Plots of DV, incl. inverse hyperbolic sine transformation

```{r}
conspiracies %>% 
  ggplot(aes(x = W2_Conspiracy_Theory3)) +
  geom_histogram(colour = "darkgrey", fill = "lightblue")

conspiracies <- conspiracies %>% 
  mutate(w2_conspiracy3_ihs = ihs(W2_Conspiracy_Theory3))

conspiracies %>% 
  ggplot(aes(x = w2_conspiracy3_ihs)) +
  geom_histogram(colour = "darkgrey", fill = "lightblue")
```

## DV 5G conspiracy - singular IV models

```{r}
sdo_5g <- lm(w2_conspiracy3_ihs ~ SDO,
              data = conspiracies)

summ(sdo_5g)
```


```{r}
rwa_5g <- lm(w2_conspiracy3_ihs ~ RWA,
              data = conspiracies)

summ(rwa_5g)
```

```{r}
daily_m_5g <- lm(w2_conspiracy3_ihs ~ 
                   W2_Newspaper_prefer1,
              data = conspiracies)

summ(daily_m_5g)
```

```{r}
social_m_5g <- lm(w2_conspiracy3_ihs ~ W2_INFO_5,
              data = conspiracies)

summ(social_m_5g)
```

## DV 5G conspiracy - socio-economic variables

```{r}
se_5g <- lm(w2_conspiracy3_ihs ~ W2_Gender_binary +
               W1_Education_binary +
               W1_Income_2019 +
               age_sc,
              data = conspiracies)

summ(se_5g, vifs = TRUE)
plot_coefs(se_5g)
par(mfrow = c(2,2))
plot(se_5g)
```

## DV 5G conspiracy - socio-economic variables + political/media

As with modelling above, fis_con is included instead of soc_con and right to avoid multicollinearity problem.  

```{r}
se_pol_5g <- lm(w2_conspiracy3_ihs ~ 
                   #socio-economic variables
                   W2_Gender_binary +
                   W1_Education_binary +
                   W1_Income_2019 +
                   age_sc +
                   
                   #political and media variables
                   fis_con +
                   nat +
                   W2_Trust_Body6 + #distrust of scientists
                   W2_Newspaper_prefer1 + #daily_mail
                   W2_Newspaper_prefer5 + #guardian
                   W2_Newspaper_prefer9 + #sun
                   W2_INFO_5 + #social media
                   W2_INFO_9,
                 data = conspiracies)

summ(se_pol_5g, vifs = TRUE)
plot_coefs(se_pol_5g)
par(mfrow = c(2,2))
plot(se_pol_5g)
```

## DV 5G conspiracy - socio-economic variables + political/media + pol-psych

```{r}
se_polpsych_5g <- lm(w2_conspiracy3_ihs ~
                        #socio-economic variables
                        W2_Gender_binary +
                        W1_Education_binary +
                        W1_Income_2019 +
                        age_sc +
                        
                        #political and media variables
                        fis_con +
                        nat +
                        W2_Trust_Body6 + #distrust of scientists
                        W2_Newspaper_prefer1 + #daily_mail
                        W2_Newspaper_prefer5 + #guardian
                        W2_Newspaper_prefer9 + #sun
                        W2_INFO_5 + #social media
                        W2_INFO_9 + #family and friends
                     
                        #political-psychology variables
                        SDO +
                        RWA +
                        W2_DAI_Total +
                        W2_IOU_Total +
                        W2_Paranoia_Total +
                        W2_Internal_Total +
                        W2_Chance_Total,
                     data = conspiracies)

summ(se_polpsych_5g, vifs = TRUE)
plot_coefs(se_polpsych_5g)
par(mfrow = c(2,2))
plot(se_polpsych_5g)
```


## DV 5G conspiracy - socio-economic variables + political/media + pol-psych + covid-threat

```{r}
multi_5g <- lm(w2_conspiracy3_ihs ~ 
                  #socio-economic variables
                  W2_Gender_binary +
                  W1_Education_binary +
                  W1_Income_2019 +
                  age_sc +
                  
                  #political and media variables
                  fis_con +
                  nat +
                  W2_Trust_Body6 + #distrust of scientists
                  W2_Newspaper_prefer1 + #daily_mail
                  W2_Newspaper_prefer5 + #guardian
                  W2_Newspaper_prefer9 + #sun
                  W2_INFO_5 + #social media
                  W2_INFO_9 + #family and friends
                  
                  #political-psychology variables
                  SDO +
                  RWA +
                  W2_DAI_Total +
                  W2_IOU_Total +
                  W2_Paranoia_Total +
                  W2_Internal_Total +
                  W2_Chance_Total +
                  
                  #covid-anxety
                  threat,
                 data = conspiracies)

summ(multi_5g, vifs = TRUE)
plot_coefs(multi_5g)
par(mfrow = c(2,2))
plot(multi_5g)
```

As with the Chinese lab belief, the locus of control variables (W2_Internal_Total and W2_Chance_Total) appear unrelated to the DV, and are omitted in subsequent models.  

## DV 5G conspiracy - multivariate and interaction model


```{r}
int_5g <- lm(w2_conspiracy3_ihs ~
                  #socio-economic variables
                  W2_Gender_binary +
                  W1_Education_binary +
                  W1_Income_2019 +
                  age_sc +
                  
                  #political and media variables
                  fis_con +
                  nat +
                  W2_Trust_Body6 + #distrust of scientists
                  W2_Newspaper_prefer1 + #daily_mail
                  W2_Newspaper_prefer5 + #guardian
                  W2_Newspaper_prefer9 + #sun
                  
                  #political-psychology variables
                  RWA +
                  W2_DAI_Total +
                  W2_IOU_Total +
                  W2_Paranoia_Total +
                  
                  #covid-anxety
                  threat +
                  
                  #interactions
                  W2_INFO_5:SDO +
                  W2_INFO_9:SDO,
             data = conspiracies)

summ(int_5g, vifs = TRUE)
plot_coefs(int_5g)
par(mfrow = c(2,2))
plot(int_5g)
```


```{r}
AIC(multi_5g)
AIC(int_5g) # reasonable support for interaction terms at this point
```

## DV 5G conspiracy - socio-economic variables + political/media + pol-psych + covid-threat and CRT + conspiracies

```{r}
full_5g <- lm(w2_conspiracy3_ihs ~
                #socio-economic variables
                W2_Gender_binary +
                W1_Education_binary +
                W1_Income_2019 +
                age_sc +
                  
                #political and media variables
                fis_con +
                nat +
                W2_Trust_Body6 + #distrust of scientists
                W2_Newspaper_prefer1 + #daily_mail
                W2_Newspaper_prefer5 + #guardian
                W2_Newspaper_prefer9 + #sun
                W2_INFO_5 + #social media
                W2_INFO_9 + #family and friends
                  
                #political-psychology variables
                SDO +
                RWA +
                W2_DAI_Total +
                W2_IOU_Total +
                W2_Paranoia_Total +
                
                #covid-anxety
                threat +
                  
                #conspiracies
                W1_Conspiracy_Total +
                conspiracy1_sc +
                conspiracy2_sc,
              data = conspiracies)

summ(full_5g, vifs = TRUE)
plot_coefs(full_5g)
par(mfrow = c(2,2))
plot(full_5g)
```


```{r}
full_int_5g <- lm(w2_conspiracy3_ihs ~
                #socio-economic variables
                W2_Gender_binary +
                W1_Education_binary +
                W1_Income_2019 +
                age_sc +
                  
                #political and media variables
                fis_con +
                nat +
                W2_Trust_Body6 + #distrust of scientists
                W2_Newspaper_prefer1 + #daily_mail
                W2_Newspaper_prefer5 + #guardian
                W2_Newspaper_prefer9 + #sun
                #W2_INFO_5 + #social media
                #W2_INFO_9 + #family and friends
                  
                #political-psychology variables
                #SDO +
                RWA +
                W2_DAI_Total +
                W2_IOU_Total +
                W2_Paranoia_Total +
                
                #covid-anxety
                threat +
                  
                #conspiracies
                W1_Conspiracy_Total +
                conspiracy1_sc +
                conspiracy2_sc +
                
                # interactions
                W2_INFO_5:SDO +
                W2_INFO_9:SDO,
              data = conspiracies)

summ(full_int_5g, vifs = TRUE)
plot_coefs(full_int_5g)
par(mfrow = c(2,2))
plot(full_int_5g)
```

```{r}
# comparing AIC with and without interaction
AIC(full_5g)
AIC(full_int_5g) # reasonable support for interaction effect
```



# Parsimonious models

## Chinese lab belief

```{r}
pars_lab <- lm(W2_Conspiracy_Theory1 ~
                  
                  #socio-economic variables
                  W1_Education_binary +
                  
                  #political and media variables
                  nat +
                  W2_Trust_Body6 + #distrust of scientists
                  W2_Newspaper_prefer1 + #daily_mail
                  W2_Newspaper_prefer9 + #sun
                  W2_INFO_9 + #family and friends
                  
                  #political-psychology variables
                  SDO +
                  RWA +
                  W2_DAI_Total +
                  W2_IOU_Total +
                  W2_Paranoia_Total +
                  
                  #covid-anxiety
                  threat +
                  
                  #conspiracies
                  W1_Conspiracy_Total +
                  conspiracy2_sc +
                  conspiracy3_sc,
                data = conspiracies)

summ(pars_lab, vifs = TRUE)
plot_coefs(pars_lab)
par(mfrow = c(2,2))
plot(pars_lab)
```


## 5G origin belief

```{r}
pars_5g <- lm(w2_conspiracy3_ihs ~
                #socio-economic variables
                W1_Income_2019 +
                  
                #political and media variables
                W2_Trust_Body6 + #distrust of scientists
                  
                #political-psychology variables
                W2_DAI_Total +
                W2_IOU_Total +
                W2_Paranoia_Total +
                
                #conspiracies
                conspiracy1_sc +
                
                # interactions
                W2_INFO_5:SDO +
                W2_INFO_9:SDO,
              data = conspiracies)

summ(pars_5g, vifs = TRUE)
plot_coefs(pars_5g)
par(mfrow = c(2,2))
plot(pars_5g)
```


```{r}
summary(full_int_5g)$adj.r.squared
summary(pars_5g)$adj.r.squared
AIC(full_int_5g)
AIC(pars_5g)
```

# Ranking of conspiracies

```{r}
## [maxn] Function to find nth highest column position for each row (to use among a subset of data)
maxn <- function(n) function(x) order(x, decreasing = TRUE)[n]  
```

```{r}
## Create differenced DV: item - highest or next highest probability X item probability/100
subs <- names(pca_df)[1:3]

conspiracies$c_first <- apply(conspiracies[subs],
                              1, 
                              function(x)x[maxn(1)(x)])  # Highest probability
```

```{r}
conspiracies$c_second <- apply(conspiracies[subs],
                              1, 
                              function(x)x[maxn(2)(x)])  # 2nd highest probability
```

```{r}
conspiracies$c_third <- apply(conspiracies[subs],
                              1, 
                              function(x)x[maxn(3)(x)])  # 3rd highest probability
```

```{r}
## A start to creating a differenced DV using the name of the top conspiracy and their ratings...

c_first_name <- rep(NA,nrow(conspiracies))

for(i in 1:nrow(conspiracies)){
  
  if(conspiracies$c_first[i] == 
     conspiracies$W2_Conspiracy_Theory1[i]){
    c_first_name[i] <- subs[1]
    } else if(conspiracies$c_first[i] ==
              conspiracies$W2_Conspiracy_Theory2[i]){
      c_first_name[i] <- subs[2]
      } else {
        c_first_name[i] <- subs[3]
        }
  
}

c_second_name <- rep(NA,nrow(conspiracies))

for(i in 1:nrow(conspiracies)){
  
  if(conspiracies$c_second[i] == 
     conspiracies$W2_Conspiracy_Theory1[i]){
    c_second_name[i] <- subs[1]
    } else if(conspiracies$c_second[i] ==
              conspiracies$W2_Conspiracy_Theory2[i]){
      c_second_name[i] <- subs[2]
      } else {
        c_second_name[i] <- subs[3]
        }
  
}

c_third_name <- rep(NA,nrow(conspiracies))

for(i in 1:nrow(conspiracies)){
  
  if(conspiracies$c_third[i] == 
     conspiracies$W2_Conspiracy_Theory1[i]){
    c_third_name[i] <- subs[1]
    } else if(conspiracies$c_third[i] ==
              conspiracies$W2_Conspiracy_Theory2[i]){
      c_third_name[i] <- subs[2]
      } else {
        c_third_name[i] <- subs[3]
        }
  
}

conspiracies <- cbind(conspiracies, 
                      c_first_name, 
                      c_second_name, 
                      c_third_name)
```


```{r}
# c1_diff, c1_diff_norm, c2_diff, c2_diff_norm, c3_diff, c3_diff_norm

conspiracies <- conspiracies %>% 
  mutate(
    c1_diff = c_first - c_second,
    c2_diff = c_second - c_third,
    c3_diff = c_first - c_third,
    c1_diff_norm = c1_diff * c_first / 100,
    c2_diff_norm = c2_diff * c_second / 100,
    c3_diff_norm = c3_diff * c_first / 100
  )
```


```{r}
conspiracies %>% 
  filter(c1_diff != 0) %>%
  mutate(c_first_name = fct_recode(c_first_name,
                                   "Chinese lab" =
                                     "W2_Conspiracy_Theory1",
                                   "Chinese meat market" = 
                                     "W2_Conspiracy_Theory2",
                                   "5G" = 
                                     "W2_Conspiracy_Theory3")) %>% 
  ggplot(aes(x = c1_diff_norm)) +
  geom_density(aes(colour = c_first_name, fill = c_first_name),
               size = 1, alpha = 0.6) +
  facet_wrap(~c_first_name, ncol = 1) +
  scale_colour_brewer(palette = "Dark2") +
  scale_fill_brewer(palette = "Dark2") +
  theme(legend.position = "top") +
  labs(colour = "Conspiracy", fill = "Conspiracy")
```


```{r}
lab_believers <- conspiracies %>% 
  filter(c1_diff != 0 & c_first_name == "W2_Conspiracy_Theory1")

pars_lab_diff <- lm(log(c1_diff_norm) ~
                  
                  #socio-economic variables
                  W1_Education_binary +
                  
                  #political and media variables
                  nat +
                  W2_Trust_Body6 + #distrust of scientists
                  W2_Newspaper_prefer1 + #daily_mail
                  W2_Newspaper_prefer9 + #sun
                  W2_INFO_9 + #family and friends
                  
                  #political-psychology variables
                  SDO +
                  RWA +
                  W2_DAI_Total +
                  W2_IOU_Total +
                  W2_Paranoia_Total +
                  
                  #covid-anxiety
                  threat +
                  
                  #conspiracies
                  W1_Conspiracy_Total,
                data = lab_believers)

summ(pars_lab_diff, vifs = TRUE)
plot_coefs(pars_lab_diff)
par(mfrow = c(2,2))
plot(pars_lab_diff)
```

```{r}
pr_ggplot(pars_lab_diff)
```


```{r}
fiveg_believers <- conspiracies %>% 
  filter(c1_diff != 0 & c_first_name == "W2_Conspiracy_Theory3")

# only 54 observations in this dataset
nrow(fiveg_believers)

pars_5g_diff <- lm(log(c1_diff_norm) ~
                #socio-economic variables
                W1_Income_2019 +
                  
                #political and media variables
                W2_Trust_Body6 + #distrust of scientists
                  
                #political-psychology variables
                W2_DAI_Total +
                W2_IOU_Total +
                W2_Paranoia_Total +
                
                #conspiracies
                W1_Conspiracy_Total +
                
                # interactions
                W2_INFO_5:SDO +
                W2_INFO_9:SDO,
              data = fiveg_believers)

summ(pars_5g_diff, vifs = TRUE)
plot_coefs(pars_5g_diff)
par(mfrow = c(2,2))
plot(pars_5g_diff)
```


